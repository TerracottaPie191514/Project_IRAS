 # Effect of antibiotic usage on the microbiome and resistome in broiler chickens: a field study.

This repository serves as the central hub for all scripts created within the project on antibiotic usage in broiler chickens. This project is set up within the [IRAS institute](https://www.uu.nl/en/organisation/faculty-of-veterinary-medicine/veterinary-research/one-health/risk-assessment-sciences). The bash scripts in [this folder](Pipeline) are used in the pipeline to get resistomic data from 120 metagenomic samples. First off, samples are [merged](Pipeline/merge.sh), after which [trimming](Pipeline/clean.sh) occurs. The samples are quality checked both [before](Pipeline/pre_qc.sh) and [after](Pipeline/post_qc.sh) trimming. Then, the reads are [mapped](Pipeline/map_resistome.sh) to a resistome database (Resfinder). Reads are also mapped against the bacteriome with both [MetaPhlAn](Pipeline/map_bacteriome_metaphlan.sh) and [Kraken2](Pipeline/map_bacteriome_kraken2.sh). From these mappings, the total bacteriome reads mapped are calculated  for [MetaPhlAn](Pipeline/extract_numreads_metaphlan.sh) and [Kraken2](Pipeline/extract_numreads_kraken2.sh). For Kraken 2, the total bacterial load in addition to the percentage of bacterial reads mapped is also [gathered](Pipeline/extract_bacterial_load_k2.sh). Another [script](Pipeline/concat.sh) concatenates the outputs of resistome mapping, and combines all output into a single file. Finally, an [R script](Pipeline/correct_and_construct_phyloseq.R) corrects for gene length and sequencing depth by FPKM and TPM conversion for both Kraken 2 and MetaPhlAn data and constructs and saves phyloseq objects for these datasets.\
Analyses of the data are performed on [metataxonomic](16S), [metagenomic](MG) and [resistomic](Resistome) layers. Each of the scripts found in these folders are strung together in a large [Rmarkdown file](Project_IRAS.rmd), of which the pdf can be found [here](Project_IRAS.pdf). Referenced throughout the report chronologically are: the genera plots (p18-22, p205-209, and p418-422), heatmaps of multiple variables (p40-42, p216-220, and p445-448), alternative clustering approaches (p142-169, p361-384, and p585-611), other variables in PAM clustering (p172 -174, p387-389, and p614-616), scaled rarefaction curves (p465-467), histograms (p64-70, p251-257, and p487-492) and statistical results for multiple variables (p70-81, p257-268, and p492-508).\
SIMPER was performed to assess which taxa have the most impact on Bray-Curtis dissimilarity (for the variables age, farm, and antibiotics application). External scripts to automate the application of both SIMPER and Kruskal-Wallis tests can be found in [this folder](Steinberger_scripts), and are taken from https://github.com/asteinberger9/seq_scripts.
